---

  # all
  - hosts: all
    gather_facts: yes
    become: true

    tasks:

    - name: Create LVM
      # command: test -b /dev/sdb
      # register: sdb
      # failed_when: sdb.rc is not defined
      # changed_when: >
      #   sdb.stdout == "Error: Partition doesn't exist."

    - lvol: vg=datavg lv=data size=128 pvs=/dev/sdb

    - name: Mount data LV
      mount: name=/data src=/dev/datavg/data fstype=ext4
             state=mounted opts="errors=remount-ro,noatime,barrier=0"
             dump=0 passno=2
